{"version":3,"file":"strategies.js","sources":["../../../../../src/activities/chat/stream/strategies.ts"],"sourcesContent":["/**\n * Built-in Chunk Strategies\n *\n * Strategies for controlling when text updates are emitted to the UI\n */\n\nimport type { ChunkStrategy } from './types'\n\n/**\n * Immediate Strategy - emit on every chunk (default behavior)\n */\nexport class ImmediateStrategy implements ChunkStrategy {\n  shouldEmit(_chunk: string, _accumulated: string): boolean {\n    return true\n  }\n}\n\n/**\n * Punctuation Strategy - emit when chunk contains punctuation\n * Useful for natural text flow in UI\n */\nexport class PunctuationStrategy implements ChunkStrategy {\n  private punctuation = /[.,!?;:\\n]/\n\n  shouldEmit(chunk: string, _accumulated: string): boolean {\n    return this.punctuation.test(chunk)\n  }\n}\n\n/**\n * Batch Strategy - emit every N chunks\n * Useful for reducing UI update frequency\n */\nexport class BatchStrategy implements ChunkStrategy {\n  private chunkCount = 0\n\n  constructor(private batchSize: number = 5) {}\n\n  shouldEmit(_chunk: string, _accumulated: string): boolean {\n    this.chunkCount++\n    if (this.chunkCount >= this.batchSize) {\n      this.chunkCount = 0\n      return true\n    }\n    return false\n  }\n\n  reset(): void {\n    this.chunkCount = 0\n  }\n}\n\n/**\n * Word Boundary Strategy - emit at word boundaries\n * Prevents cutting words in half\n */\nexport class WordBoundaryStrategy implements ChunkStrategy {\n  shouldEmit(chunk: string, _accumulated: string): boolean {\n    // Emit if chunk ends with whitespace\n    return /\\s$/.test(chunk)\n  }\n}\n\n/**\n * Composite Strategy - combine multiple strategies (OR logic)\n * Emits if ANY strategy says to emit\n */\nexport class CompositeStrategy implements ChunkStrategy {\n  constructor(private strategies: Array<ChunkStrategy>) {}\n\n  shouldEmit(chunk: string, accumulated: string): boolean {\n    return this.strategies.some((s) => s.shouldEmit(chunk, accumulated))\n  }\n\n  reset(): void {\n    this.strategies.forEach((s) => s.reset?.())\n  }\n}\n"],"names":[],"mappings":"AAWO,MAAM,kBAA2C;AAAA,EACtD,WAAW,QAAgB,cAA+B;AACxD,WAAO;AAAA,EACT;AACF;AAMO,MAAM,oBAA6C;AAAA,EAAnD,cAAA;AACL,SAAQ,cAAc;AAAA,EAAA;AAAA,EAEtB,WAAW,OAAe,cAA+B;AACvD,WAAO,KAAK,YAAY,KAAK,KAAK;AAAA,EACpC;AACF;AAMO,MAAM,cAAuC;AAAA,EAGlD,YAAoB,YAAoB,GAAG;AAAvB,SAAA,YAAA;AAFpB,SAAQ,aAAa;AAAA,EAEuB;AAAA,EAE5C,WAAW,QAAgB,cAA+B;AACxD,SAAK;AACL,QAAI,KAAK,cAAc,KAAK,WAAW;AACrC,WAAK,aAAa;AAClB,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT;AAAA,EAEA,QAAc;AACZ,SAAK,aAAa;AAAA,EACpB;AACF;AAMO,MAAM,qBAA8C;AAAA,EACzD,WAAW,OAAe,cAA+B;AAEvD,WAAO,MAAM,KAAK,KAAK;AAAA,EACzB;AACF;AAMO,MAAM,kBAA2C;AAAA,EACtD,YAAoB,YAAkC;AAAlC,SAAA,aAAA;AAAA,EAAmC;AAAA,EAEvD,WAAW,OAAe,aAA8B;AACtD,WAAO,KAAK,WAAW,KAAK,CAAC,MAAM,EAAE,WAAW,OAAO,WAAW,CAAC;AAAA,EACrE;AAAA,EAEA,QAAc;AACZ,SAAK,WAAW,QAAQ,CAAC,MAAM,EAAE,SAAS;AAAA,EAC5C;AACF;"}