{"version":3,"sources":["../../src/ai/index.ts"],"sourcesContent":["/**\n * AI Gateway - Chat, Completions, and Embeddings\n * \n * @example\n * const response = await cencori.ai.chat({\n *   model: 'gpt-4o',\n *   messages: [{ role: 'user', content: 'Hello!' }]\n * });\n */\n\nimport type {\n    CencoriConfig,\n    ChatRequest,\n    ChatResponse,\n    CompletionRequest,\n    EmbeddingRequest,\n    EmbeddingResponse\n} from '../types';\n\n// API Response types\ninterface OpenAIChatResponse {\n    id: string;\n    model: string;\n    choices?: Array<{\n        message?: {\n            content?: string;\n        };\n    }>;\n    usage?: {\n        prompt_tokens?: number;\n        completion_tokens?: number;\n        total_tokens?: number;\n    };\n}\n\ninterface OpenAIEmbeddingResponse {\n    model: string;\n    data?: Array<{\n        embedding: number[];\n    }>;\n    usage?: {\n        total_tokens?: number;\n    };\n}\n\nexport class AINamespace {\n    private config: Required<CencoriConfig>;\n\n    constructor(config: Required<CencoriConfig>) {\n        this.config = config;\n    }\n\n    /**\n     * Create a chat completion\n     * \n     * @example\n     * const response = await cencori.ai.chat({\n     *   model: 'gpt-4o',\n     *   messages: [{ role: 'user', content: 'Hello!' }]\n     * });\n     */\n    async chat(request: ChatRequest): Promise<ChatResponse> {\n        const response = await fetch(`${this.config.baseUrl}/api/v1/chat/completions`, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Bearer ${this.config.apiKey}`,\n                'Content-Type': 'application/json',\n                ...this.config.headers,\n            },\n            body: JSON.stringify({\n                model: request.model,\n                messages: request.messages,\n                temperature: request.temperature,\n                max_tokens: request.maxTokens,\n                stream: request.stream ?? false,\n            }),\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json().catch(() => ({ error: 'Unknown error' })) as { error?: string };\n            throw new Error(`Cencori API error: ${errorData.error || response.statusText}`);\n        }\n\n        const data = await response.json() as OpenAIChatResponse;\n\n        return {\n            id: data.id,\n            model: data.model,\n            content: data.choices?.[0]?.message?.content ?? '',\n            usage: {\n                promptTokens: data.usage?.prompt_tokens ?? 0,\n                completionTokens: data.usage?.completion_tokens ?? 0,\n                totalTokens: data.usage?.total_tokens ?? 0,\n            },\n        };\n    }\n\n    /**\n     * Create a text completion\n     * \n     * @example\n     * const response = await cencori.ai.completions({\n     *   model: 'gpt-4o',\n     *   prompt: 'Write a haiku about coding'\n     * });\n     */\n    async completions(request: CompletionRequest): Promise<ChatResponse> {\n        // Convert to chat format internally\n        return this.chat({\n            model: request.model,\n            messages: [{ role: 'user', content: request.prompt }],\n            temperature: request.temperature,\n            maxTokens: request.maxTokens,\n        });\n    }\n\n    /**\n     * Create embeddings\n     * \n     * @example\n     * const response = await cencori.ai.embeddings({\n     *   model: 'text-embedding-3-small',\n     *   input: 'Hello world'\n     * });\n     */\n    async embeddings(request: EmbeddingRequest): Promise<EmbeddingResponse> {\n        const response = await fetch(`${this.config.baseUrl}/api/v1/embeddings`, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Bearer ${this.config.apiKey}`,\n                'Content-Type': 'application/json',\n                ...this.config.headers,\n            },\n            body: JSON.stringify({\n                model: request.model,\n                input: request.input,\n            }),\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json().catch(() => ({ error: 'Unknown error' })) as { error?: string };\n            throw new Error(`Cencori API error: ${errorData.error || response.statusText}`);\n        }\n\n        const data = await response.json() as OpenAIEmbeddingResponse;\n\n        return {\n            model: data.model,\n            embeddings: data.data?.map((d) => d.embedding) ?? [],\n            usage: {\n                totalTokens: data.usage?.total_tokens ?? 0,\n            },\n        };\n    }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AA6CO,IAAM,cAAN,MAAkB;AAAA,EAGrB,YAAY,QAAiC;AACzC,SAAK,SAAS;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,KAAK,SAA6C;AACpD,UAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,OAAO,4BAA4B;AAAA,MAC3E,QAAQ;AAAA,MACR,SAAS;AAAA,QACL,iBAAiB,UAAU,KAAK,OAAO,MAAM;AAAA,QAC7C,gBAAgB;AAAA,QAChB,GAAG,KAAK,OAAO;AAAA,MACnB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACjB,OAAO,QAAQ;AAAA,QACf,UAAU,QAAQ;AAAA,QAClB,aAAa,QAAQ;AAAA,QACrB,YAAY,QAAQ;AAAA,QACpB,QAAQ,QAAQ,UAAU;AAAA,MAC9B,CAAC;AAAA,IACL,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,YAAY,MAAM,SAAS,KAAK,EAAE,MAAM,OAAO,EAAE,OAAO,gBAAgB,EAAE;AAChF,YAAM,IAAI,MAAM,sBAAsB,UAAU,SAAS,SAAS,UAAU,EAAE;AAAA,IAClF;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,WAAO;AAAA,MACH,IAAI,KAAK;AAAA,MACT,OAAO,KAAK;AAAA,MACZ,SAAS,KAAK,UAAU,CAAC,GAAG,SAAS,WAAW;AAAA,MAChD,OAAO;AAAA,QACH,cAAc,KAAK,OAAO,iBAAiB;AAAA,QAC3C,kBAAkB,KAAK,OAAO,qBAAqB;AAAA,QACnD,aAAa,KAAK,OAAO,gBAAgB;AAAA,MAC7C;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,YAAY,SAAmD;AAEjE,WAAO,KAAK,KAAK;AAAA,MACb,OAAO,QAAQ;AAAA,MACf,UAAU,CAAC,EAAE,MAAM,QAAQ,SAAS,QAAQ,OAAO,CAAC;AAAA,MACpD,aAAa,QAAQ;AAAA,MACrB,WAAW,QAAQ;AAAA,IACvB,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,MAAM,WAAW,SAAuD;AACpE,UAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,OAAO,sBAAsB;AAAA,MACrE,QAAQ;AAAA,MACR,SAAS;AAAA,QACL,iBAAiB,UAAU,KAAK,OAAO,MAAM;AAAA,QAC7C,gBAAgB;AAAA,QAChB,GAAG,KAAK,OAAO;AAAA,MACnB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACjB,OAAO,QAAQ;AAAA,QACf,OAAO,QAAQ;AAAA,MACnB,CAAC;AAAA,IACL,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,YAAY,MAAM,SAAS,KAAK,EAAE,MAAM,OAAO,EAAE,OAAO,gBAAgB,EAAE;AAChF,YAAM,IAAI,MAAM,sBAAsB,UAAU,SAAS,SAAS,UAAU,EAAE;AAAA,IAClF;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,WAAO;AAAA,MACH,OAAO,KAAK;AAAA,MACZ,YAAY,KAAK,MAAM,IAAI,CAAC,MAAM,EAAE,SAAS,KAAK,CAAC;AAAA,MACnD,OAAO;AAAA,QACH,aAAa,KAAK,OAAO,gBAAgB;AAAA,MAC7C;AAAA,IACJ;AAAA,EACJ;AACJ;","names":[]}